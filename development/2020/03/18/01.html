<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.0 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>golang GO routine channel 테스트 - 별거있나</title>
<meta name="description" content="요즘 핫하다는 golang, 과거에는 Android app개발을 주로 해왔던 터라, Java를 사용하다가 근래에 주로 사용하는 언어가 Python으로 변경이 되면서 초반에는 심플한 문법… 파이써닉하다. 라는 표현에 매료되어 찬양할 수 밖에 없는 경험을 해왔다. 하지만 사용하면 할수록 단점들도 보이기 시작했다. 물론 단점이 있다고 나쁘다는 건 아니다. 단점이 없는 언어는 없을 것이기에… 넘쳐나는 다양한 Module들과 이로인해 간단한 기능을 수행하기 위한 코드를 작성하는 데는 아직도 Python이 가장 먼저 떠오른다. 하지만 좀 더 복잡도 있고, 안정적인 프로그램을 만들어야하는 상황이 되면 Python을 택하는 데 조금 고민이 되기 시작했다. ">


  <meta name="author" content="absyun">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="별거있나">
<meta property="og:title" content="golang GO routine channel 테스트">
<meta property="og:url" content="https://absyun.github.io/development/2020/03/18/01.html">


  <meta property="og:description" content="요즘 핫하다는 golang, 과거에는 Android app개발을 주로 해왔던 터라, Java를 사용하다가 근래에 주로 사용하는 언어가 Python으로 변경이 되면서 초반에는 심플한 문법… 파이써닉하다. 라는 표현에 매료되어 찬양할 수 밖에 없는 경험을 해왔다. 하지만 사용하면 할수록 단점들도 보이기 시작했다. 물론 단점이 있다고 나쁘다는 건 아니다. 단점이 없는 언어는 없을 것이기에… 넘쳐나는 다양한 Module들과 이로인해 간단한 기능을 수행하기 위한 코드를 작성하는 데는 아직도 Python이 가장 먼저 떠오른다. 하지만 좀 더 복잡도 있고, 안정적인 프로그램을 만들어야하는 상황이 되면 Python을 택하는 데 조금 고민이 되기 시작했다. ">







  <meta property="article:published_time" content="2020-03-18T22:15:00+09:00">






<link rel="canonical" href="https://absyun.github.io/development/2020/03/18/01.html">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://absyun.github.io/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="별거있나 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--postings">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          별거있나
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/">Archive</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/">Category</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/common/intro_crop.png" alt="absyun" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">absyun</h3>
    
    
      <div class="author__bio" itemprop="description">
        

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Korea</span>
        </li>
      

      

      

      
        <li>
          <a href="mailto:tjln0608@gmail.com">
            <meta itemprop="email" content="tjln0608@gmail.com" />
            <i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i> Email
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://github.com/absyun" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <div class="archive">
    
      <h1 id="page-title" class="page__title">golang GO routine channel 테스트</h1>
    
    <head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-161444856-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-161444856-1');
</script>

</head>

<p>요즘 핫하다는 golang, 과거에는 Android app개발을 주로 해왔던 터라, Java를 사용하다가 근래에 주로 사용하는 언어가 Python으로 변경이 되면서 초반에는 심플한 문법… 파이써닉하다. 라는 표현에 매료되어 찬양할 수 밖에 없는 경험을 해왔다. 하지만 사용하면 할수록 단점들도 보이기 시작했다. 물론 단점이 있다고 나쁘다는 건 아니다. 단점이 없는 언어는 없을 것이기에… 넘쳐나는 다양한 Module들과 이로인해 간단한 기능을 수행하기 위한 코드를 작성하는 데는 아직도 Python이 가장 먼저 떠오른다. 하지만 좀 더 복잡도 있고, 안정적인 프로그램을 만들어야하는 상황이 되면 Python을 택하는 데 조금 고민이 되기 시작했다.</p>

<p>Type… 이건 Python에게 양날의 검이라고 할 수 있는 것 같다.
최초 Python을 접했을 땐, Type에 대한 고민을 하지 않는 것이 너무도 편했다. Function pointer 같은 복잡한 Type도 그냥 알아서 판단을 해주기에 코드양도 많이 줄어들고, 자잘한 실수로 컴파일 에러를 볼일이 없어지는 것에 굉장히 만족도가 높았다.</p>

<p>하지만 누가 그랬던 가… 고통은 축복이라고… 컴파일러가 미리 잡아주던 Syntax 문제를 런타임에 몇번 맞고 나면서… 미리 맞는 고통에 감사하게 되었다. 물론 Python도 컴파일을 할 수 있는 기능도 있고, Unit test로 커버리지를 많이 끌어올리면 런타임에 도달하기 전에 대부분의 관련 에러를 잡을 수는 있을 것이다.
그렇지만 이러한 경험들은 역설적으로 Type strict한 언어가 가끔은 그리워지는 사건이 되었다.</p>

<p>그러던 시기에 Backend를 개발할 기회가 생겼는 데, 언어에 대한 고민을 하게 되면서 새로운 언어를 또 접해보고자 하는 마음으로 GO에 관심을 갖게 되었다.</p>

<p>기본 문법을 부터 봐가면서 느낀건… 이 언어는 정말 체계적으로 만들어졌구나, 그리고 필자는 GO를 이렇게 표현하고 싶어졌다.
Programing language 계의 한글, Python을 닮고싶은 C… (쓸데 없는 소리는 이제 그만하고… )</p>

<p>GO 언어를 조금씩 사용해가며, 이해도를 높혀가며 좀 더 심도 있게 이 언어의 강점을 이용하려면 꼭 짚고 넘어가야할 기능 중 하나가 단연코 go routine일 것이다. 타 언어에서는 Thread라는 Common한 OS의 개념 용어을 그대로 사용하는 데.. GO언어에서는 해당 기능을 go routine이라는 걸 통해서 대체할 수 있다. 심지어 다른 언어의 Thread보다 더 경량이라고 한다.</p>

<p>여러가지 실험을 하면서 go routine에 대한 특성을 이해해보고자 한다.</p>

<h2 id="1-chan">1. chan</h2>
<p>go routine을 사용하면서 chan을 사용하지 않는 경우는 드물 것이다. 물론 독자적으로 돌고 종료하는 로직도 있을 수는 있지만, 많은 경우 Main thread에서 Lock 되지 않도록 background로 특정 기능을 수행하기 때문에 background 기능이 끝나고나면 Noti를 받고 그 결과를 어딘가에 반영해야하는 경우가 많기 때문이다. 이때 chan을 이용하면 go routine과 데이터 송수신이 가능하다.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">test</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">a</span> <span class="kt">int</span>
	<span class="n">b</span> <span class="kt">string</span>
<span class="p">}</span>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">stringCh</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">string</span><span class="p">)</span>
	<span class="n">structCh</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="n">test</span><span class="p">)</span>
	<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"GO routine"</span><span class="p">)</span>
		<span class="n">stringCh</span> <span class="o">&lt;-</span> <span class="s">"done"</span>
		<span class="n">structCh</span> <span class="o">&lt;-</span> <span class="n">test</span><span class="p">{</span><span class="m">0</span><span class="p">,</span> <span class="s">"done"</span><span class="p">}</span>

	<span class="p">}()</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"result1:"</span><span class="p">,</span> <span class="o">&lt;-</span><span class="n">stringCh</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"result2:"</span><span class="p">,</span> <span class="o">&lt;-</span><span class="n">structCh</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<p>Channel을 원하는 자료형으로 선언하고 데이터를 전달하고 받는 샘플이다.</p>

<h2 id="2-channel은-make로-초기화한다">2. Channel은 Make로 초기화한다.</h2>
<p>Channel은 make 명령으로 최초에 생성한다.
생성시 Type을 지정을 지정해야만 golang의 void pointer와 같은 interface 타입도 사용가능하다.</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">test</span> <span class="k">struct</span> <span class="p">{</span>
	<span class="n">a</span> <span class="kt">int</span>
	<span class="n">b</span> <span class="kt">string</span>
<span class="p">}</span>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">interCh</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="k">interface</span><span class="p">{})</span>
	<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"GO routine"</span><span class="p">)</span>
		<span class="n">interCh</span> <span class="o">&lt;-</span> <span class="s">"done"</span>
		<span class="n">interCh</span> <span class="o">&lt;-</span> <span class="n">test</span><span class="p">{</span><span class="m">0</span><span class="p">,</span> <span class="s">"done"</span><span class="p">}</span>
		<span class="n">interCh</span> <span class="o">&lt;-</span> <span class="m">3</span>
	<span class="p">}()</span>
	<span class="c">//get first result</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"result1:"</span><span class="p">,</span> <span class="o">&lt;-</span><span class="n">interCh</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"result2:"</span><span class="p">,</span> <span class="o">&lt;-</span><span class="n">interCh</span><span class="p">)</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"result3:"</span><span class="p">,</span> <span class="o">&lt;-</span><span class="n">interCh</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GO routine
result1: <span class="k">done
</span>result2: <span class="o">{</span>0 <span class="k">done</span><span class="o">}</span>
result3: 3
</code></pre></div></div>
<h2 id="3-실행순서는-랜덤">3. 실행순서는 랜덤</h2>
<p>Go routine을 빠른 순서로 순차 실행시 실제 Running순서는 보장되지 않는다.</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">interCh</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="k">interface</span><span class="p">{})</span>
	<span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="m">5</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
		<span class="n">j</span> <span class="o">:=</span> <span class="n">i</span>
		<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
			<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
		<span class="p">}()</span>
	<span class="p">}</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="o">&lt;-</span><span class="n">interCh</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>
<p>결과는 늘 다르다.</p>
<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4
1
2
3
0
</code></pre></div></div>
<p>위의 코드는 일단 panic이다. interCh로 부터 값을 건네받기 위해 대기를 시키지만, interCh쪽으로 값을 보내주는 코드는 없기 때문이다.
이는 go routine들을 실행하고 바로 Main thread가 종료되지 않도록 붙잡는 용도로 써넣은 코드이지만 똑똑하게도 Main thread가 무한정 기다리지 않고, 이를 깨워줄 다른 running코드가 없으니 그냥 바로 panic을 뱉어준다.</p>

<h2 id="4-일반-chan-대기하고-있어야-보낼-수-있다">4. 일반 chan 대기하고 있어야 보낼 수 있다.</h2>
<p>그냥 만든 channel은 대기를 하고 있어야지 발송이 가능하다.
아래의 코드는 int type channel을 만들고 go routine안에서 channel로 발송을 한다. 하지만 수신을 하는 코드는 없으므로 무한 대기 상태에 빠지게 되고, Main thread측에서도 go routine이 끝나길 기대리게 되니… 위와 같이 deadlock에 빠지고만다. go는 panic을 표시하며 바로 종료시켜버린다.</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">int</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
	<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
		<span class="n">ch</span> <span class="o">&lt;-</span> <span class="m">1</span>
	<span class="p">}()</span>
	<span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="o">&lt;-</span><span class="n">ch</span><span class="p">)</span> <span class="c">// 해당 부분이 없으면 deadlock</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<h2 id="5-4번의-상황을-회피하기-위한-방법-중-하나는-buffer이다">5. (4)번의 상황을 회피하기 위한 방법 중 하나는 buffer이다.</h2>
<p>make시 두번째 파라메터로 버퍼사이즈 지정이 가능하다.
버퍼가 있을 경우 chan은 수신측이 준비되지 않아도 바로 버퍼로 전송이 가능하기 때문에 4번과 같이 수신 코드가 없어도 발송을 할 수 있다. 다만 당연히 버퍼가 Full이면 (4)번 상황이 발생한다.</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
	<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
		<span class="n">ch</span> <span class="o">&lt;-</span> <span class="m">1</span>
	<span class="p">}()</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<h2 id="5-닫고-보내면-패닉">5. 닫고 보내면 패닉</h2>
<p>닫혀진 channel에 발신 시도를 할 경우 바로 panic 이다…</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">int</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
	<span class="nb">close</span><span class="p">(</span><span class="n">ch</span><span class="p">)</span>
	<span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
		<span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
		<span class="n">ch</span> <span class="o">&lt;-</span> <span class="m">1</span>
	<span class="p">}()</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ go run test.go
panic: send on closed channel
</code></pre></div></div>

<h2 id="6-channel은-수신-송신-용도-한정이-가능하다">6. channel은 수신, 송신 용도 한정이 가능하다.</h2>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">server</span><span class="p">(</span><span class="n">ch</span> <span class="o">&lt;-</span><span class="k">chan</span> <span class="kt">string</span><span class="p">,</span> <span class="n">wg</span> <span class="o">*</span><span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span><span class="p">)</span> <span class="p">{</span>
	<span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
	<span class="n">ch</span> <span class="o">&lt;-</span> <span class="s">"result"</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">ch</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="o">&lt;-</span><span class="k">chan</span> <span class="kt">string</span><span class="p">,</span> <span class="m">1</span><span class="p">)</span>
	<span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
	<span class="k">go</span> <span class="n">server</span><span class="p">(</span><span class="n">ch</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">wg</span><span class="p">)</span>

	<span class="n">fmt</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="o">&lt;-</span><span class="n">ch</span><span class="p">)</span>
	<span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div></div>
<p>위 케이스는 chan을 파라메터로 넘길때 수신용으로 한정해서 넘겼는 데, 이를 내부에서 발신용으로 사용하는 코드가 있으므로 컴파일 에러이다. 참고로”&lt;-chan”, “chan&lt;-“ 각각 수, 발신용 Type을 나태난다.</p>

<h2 id="7-select-문">7. select 문</h2>
<p>switch case와 문법은 유사하지만 용도는 조금 다르다. 여러 go routine에서 채널로 값이 전달되면 웨이팅을 하고 있다가 먼저 수신되는 channel에 해당하는 루틴이 수행된다.
select문이 수행될 때, 어느 case의 channel에도 데이터가 수신되지 않고, default가 선언되어있으면 default문이 수행된다. select문을 반복문에 포함시키게 되면 channel로 값이 수신되는 순서로 select문이 수행되는 Thread에서 처리하는 로직을 쉽게 구현할 수 있다.</p>
<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">background1</span><span class="p">(</span><span class="n">ch</span> <span class="k">chan</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">ch</span> <span class="o">&lt;-</span> <span class="s">"1"</span>
<span class="p">}</span>
<span class="k">func</span> <span class="n">background2</span><span class="p">(</span><span class="n">ch</span> <span class="k">chan</span> <span class="kt">string</span><span class="p">)</span> <span class="p">{</span>
	<span class="n">ch</span> <span class="o">&lt;-</span> <span class="s">"2"</span>
<span class="p">}</span>
<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">ch1</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">string</span><span class="p">)</span>
	<span class="n">ch2</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">(</span><span class="k">chan</span> <span class="kt">string</span><span class="p">)</span>
	<span class="k">go</span> <span class="n">background1</span><span class="p">(</span><span class="n">ch1</span><span class="p">)</span>
	<span class="k">go</span> <span class="n">background1</span><span class="p">(</span><span class="n">ch2</span><span class="p">)</span>
	<span class="n">time</span><span class="o">.</span><span class="n">Sleep</span><span class="p">(</span><span class="m">10000</span><span class="p">)</span>
	<span class="k">select</span> <span class="p">{</span>
	<span class="k">case</span> <span class="o">&lt;-</span><span class="n">ch1</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"value is transfered 1"</span><span class="p">)</span>
	<span class="k">case</span> <span class="o">&lt;-</span><span class="n">ch2</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"value is transfered 2"</span><span class="p">)</span>
	<span class="k">default</span><span class="o">:</span>
		<span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"default"</span><span class="p">)</span>
	<span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>
<p>위 코드는 sleep을 조절하여, default, ch1, ch2 수신이 적당히 랜덤으로 수행되는 테스트 코드이다. 해당 케이스를 유발하는 sleep 수치는 환경마다 다를 수 있다.</p>


<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://absyun.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


<ul class="taxonomy__index">
  
  
    <li>
      <a href="#2020">
        <strong>2020</strong> <span class="taxonomy__count">8</span>
      </a>
    </li>
  
</ul>



  <section id="2020" class="taxonomy__section">
    <h2 class="archive__subtitle">2020</h2>
    <div class="entries-list">
      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/development/2020/03/18/01.html" rel="permalink">golang GO routine channel 테스트
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">요즘 핫하다는 golang, 과거에는 Android app개발을 주로 해왔던 터라, Java를 사용하다가 근래에 주로 사용하는 언어가 Python으로 변경이 되면서 초반에는 심플한 문법… 파이써닉하다. 라는 표현에 매료되어 찬양할 수 밖에 없는 경험을 해왔다. 하지만 사용하면 할수...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/development/2020/03/18/03.html" rel="permalink">OIDC Login 구현해보기 Part-3
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  3 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">앞서 Part에서 Frontend 측에서 Browser를 통해 IDP를 거쳐 code를 받는 것 까지 진행되었다. Confidential Type의 인증은 최종적으로 Secret을 이용하여 access token을 받게 되는 데 이 Secret은 Backend 에서 보관하고 있는 ...</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/development/2020/03/18/02.html" rel="permalink">OIDC Login 구현해보기 Part-2
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">사용할 IDP를 설정했으므로, 이제 본격적으로 User에게 Input을 받을 Frontend 그리고 최종적으로 인증을 완료하고 Token을 받게될 Backend를 구현해보기로 하자.
</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/development/2020/03/18/01.html" rel="permalink">OIDC Login 구현해보기 Part-1
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">OIDC…
</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/environment/2020/03/15/04.html" rel="permalink">WSL2 … and Docker
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">WSL + VSCODE의 조합으로 많은 것들을 편리한 환경에서 수행해 올 수 있었다. 하지만 WSL에서 아쉬움으로 와 닿았던 것… 바로 Docker 실행이다. 초반에는 Docker를 포기하고 준비된 환경안에서 할 수 있는 것들에 만족해 왔지만…
</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/environment/2020/03/15/03.html" rel="permalink">Visual studio code + WSL
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Windows 10 바탕에 WSL 기반으로 개발 환경을 셋팅하고, 본격적 사용을 하다보면 불편한 점이 바로 나타난다.
</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/environment/2020/03/15/02.html" rel="permalink">Github sshkey로 계정 연결하기
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Github sshkey로 계정 연결하기
</p>
  </article>
</div>

      
        



<div class="list__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/environment/2020/03/15/01.html" rel="permalink">Windows 10 WSL
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  less than 1 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">WSL (Windows Subsystem for Linux)
</p>
  </article>
</div>

      
    </div>
    <a href="#page-title" class="back-to-top">Back to Top &uarr;</a>
  </section>


  </div>
</div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 별거있나. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>










  </body>
</html>
